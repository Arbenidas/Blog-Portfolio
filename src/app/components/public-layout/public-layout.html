<div class="noise-overlay"></div>
<div class="public-layout-bg bg-blueprint"></div>

<nav class="public-navbar">
  <div class="public-nav-container">
    <a routerLink="/" class="public-brand">
      <div class="public-brand-logo">
        <img src="logo.png" alt="Arbe Logo" class="public-brand-img" />
      </div>
      <h2 class="public-brand-text">arbes.blog</h2>
    </a>

    <div class="public-nav-right">
      <div class="public-nav-links">
        <a routerLink="/" routerLinkActive="active-link" [routerLinkActiveOptions]="{exact: true}" class="public-nav-link">{{ 'NAV.HOME' | translate }}</a>
        <span class="public-nav-separator">/</span>
        <a routerLink="/feed" routerLinkActive="active-link" class="public-nav-link">{{ 'NAV.FEED' | translate }}</a>
        <span class="public-nav-separator">/</span>
        <a routerLink="/works" routerLinkActive="active-link" class="public-nav-link">{{ 'NAV.WORKS' | translate }}</a>
        <span class="public-nav-separator">/</span>
        <a routerLink="/logs" routerLinkActive="active-link" class="public-nav-link">{{ 'NAV.LOGS' | translate }}</a>
        <span class="public-nav-separator">/</span>
        <a routerLink="/guides" routerLinkActive="active-link" class="public-nav-link">{{ 'NAV.GUIDES' | translate }}</a>
      </div>

      <!-- Authentication Links -->
      <div class="public-auth-group">
        
        <!-- Logged Out State -->
        <ng-container *ngIf="!(currentUser | async)">
          <a routerLink="/login" class="nav-auth-link">LOGIN</a>
          <a routerLink="/register" class="nav-auth-link highlight">ENROLL</a>
        </ng-container>

        <!-- Logged In State -->
        <ng-container *ngIf="currentUser | async as user">
          
          <a *ngIf="notifications.unreadCount() > 0" routerLink="/admin/author-hub" class="nav-alert-pill" style="display: flex; align-items: center; gap: 0.25rem; font-family: 'Space Mono', monospace; font-size: 0.75rem; background: var(--accent-orange); color: white; padding: 0.2rem 0.6rem; text-decoration: none; border: 1px dashed white;">
             <span class="material-symbols-outlined" style="font-size: 14px;">warning</span>
             [ {{ notifications.unreadCount() }} SYSTEM ALERT ]
          </a>

          <div class="user-menu" style="display: flex; gap: 1rem; align-items: center;">
            <a routerLink="/admin/editor" class="nav-auth-btn" style="background: var(--accent-orange); color: white; border: none; padding: 0.25rem 0.75rem; font-weight: bold; cursor: pointer;">
              <span class="material-symbols-outlined" style="font-size: 14px; vertical-align: text-bottom;">add</span>
              CREATE
            </a>
            <a [routerLink]="['/u', user.user_metadata['username'] || 'me']" class="nav-auth-link highlight">
              <span class="material-symbols-outlined" style="font-size: 14px;">account_circle</span>
              PROFILE
            </a>
            <button (click)="logout()" class="nav-auth-btn">LOGOUT</button>
          </div>
        </ng-container>

      </div>

      <div class="public-status-group">
        <button class="lang-toggle-btn" (click)="languageService.toggleLanguage()">
          [{{ languageService.activeLang() | uppercase }}]
        </button>
        <div class="public-status">
          <span class="public-status-dot"></span>
          <span class="public-status-text">{{ 'NAV.STATUS' | translate }}</span>
        </div>
      </div>
    </div>
  </div>
</nav>

<div class="content-wrapper" [@routeAnimations]="animationState()">
  <router-outlet #outlet="outlet" (activate)="prepareRoute(outlet)"></router-outlet>
</div>

<app-site-footer></app-site-footer>
