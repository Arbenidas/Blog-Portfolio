<main class="guides-main" id="guides">
  <div class="coffee-stain" style="top: 8rem; left: 2.5rem; opacity: 0.7;"></div>

  <div class="guides-content-wrap">

    <div class="guides-header">
      <div>
        <h1 class="guides-title">
          Field Guides<br/>
          <span class="transparent-stroke">Knowledge DB</span>
        </h1>
      </div>
      <div class="guides-stats">
        <div class="guides-total-badge">
          TOTAL_ENTRIES: {{ guides.length }}
        </div>
        <p class="guides-meta">
          Status: <span class="guides-status-online">ONLINE</span>
        </p>
      </div>
    </div>

    <!-- LOADING SKELETON -->
    <div *ngIf="isLoading" class="guides-grid" style="opacity: 0.7;">
      <div *ngFor="let i of [1,2,3]" class="guide-card">
        <div style="height: 160px; background-color: #e5e7eb; animation: pulse 2s infinite;"></div>
        <div style="padding: 1rem;">
          <div style="height: 14px; background-color: #d1d5db; margin-bottom: 12px; width: 40%;"></div>
          <div style="height: 20px; background-color: #d1d5db; margin-bottom: 12px; width: 80%;"></div>
          <div style="height: 12px; background-color: #e5e7eb; width: 100%;"></div>
        </div>
      </div>
    </div>

    <!-- REAL CONTENT -->
    <ng-container *ngIf="!isLoading">
      <div *ngIf="guides.length === 0" class="empty-guides">
        <span class="material-symbols-outlined" style="font-size: 3rem; margin-bottom: 1rem;">menu_book</span>
        <span class="empty-guides-text">No guides published yet. Check back soon.</span>
      </div>

      <div *ngIf="guides.length > 0" class="guides-grid">
        <a *ngFor="let guide of guides; let i = index" 
           class="guide-card list-anim-item"
           [routerLink]="['/guides', guide.slug]">
          
          <div class="guide-cover" *ngIf="guide.coverPhoto">
            <img [src]="guide.coverPhoto.split('#')[0]" class="guide-cover-img">
          </div>
          <div class="guide-cover guide-cover-placeholder" *ngIf="!guide.coverPhoto">
            <span class="material-symbols-outlined" style="font-size: 3rem; color: var(--charcoal); opacity: 0.3;">menu_book</span>
          </div>

          <div class="guide-body">
            <div class="guide-meta-row">
              <span class="guide-id">GUIDE_{{ (guide.id || '').slice(0, 5) | uppercase }}</span>
              <span class="guide-date">{{ guide.createdAt | date:'dd.MMM.yy' }}</span>
            </div>
            <h2 class="guide-title">{{ guide.title }}</h2>
            <p class="guide-preview">
              {{ guide.blocks.length > 0 && guide.blocks[0].type === 'p' ? guide.blocks[0].content : 'Field guide entry.' }}
            </p>
            <div class="guide-tags">
              <span *ngFor="let tag of guide.tags" class="guide-tag">#{{ tag }}</span>
            </div>
          </div>
        </a>
      </div>
    </ng-container>

  </div>
</main>
