<main class="logs-main" id="logs">
  <div class="coffee-stain" style="top: 8rem; left: 2.5rem; opacity: 0.7;"></div>
  <div class="coffee-stain" style="top: 24rem; right: 5rem; opacity: 0.4; transform: scale(1.25);"></div>

  <div class="logs-content-grid">
    <!-- LEFT SIDEBAR -->
    <aside class="logs-sidebar">
      <div class="topic-matrix-card ink-border">
        <div class="tape-strip" style="top: -12px; left: 40%;"></div>
        <h3 class="topic-title">
          <span class="material-symbols-outlined">tag</span> Topic Matrix
        </h3>
        <div class="tag-list">
          <a *ngFor="let tag of popularTags" [ngClass]="tag.class" class="tag-item">{{ tag.name }}</a>
          <span *ngIf="popularTags.length === 0" style="font-family: var(--font-mono); font-size: 10px;">AWAITING DATA...</span>
        </div>
        
        <div class="topic-note-container">
          <p class="topic-note">
            "Note to self: The #DESIGN_SYS tags need cleanup. Too much clutter." - Arbe
          </p>
        </div>
      </div>

      <div class="frequency-card">
        <div class="frequency-live-badge">LIVE DATA</div>
        <h3 class="frequency-title">Log Frequency</h3>
        
        <div class="chart-container">
          <div *ngFor="let data of chartData; let i = index" class="chart-bar group" [ngClass]="'chart-bar-' + (i + 1)" [style.height.%]="data.height">
            <div class="chart-bar-tooltip">{{ data.month }}</div>
          </div>
          <svg class="frequency-chart-svg" preserveAspectRatio="none" viewBox="0 0 100 100">
            <path [attr.d]="chartPath" class="svg-path-anim" fill="none" stroke="#d94e1e" stroke-dasharray="3,3" stroke-width="2"></path>
            <circle *ngFor="let p of chartData" [attr.cx]="p.cx" [attr.cy]="p.cy" fill="#fff" r="2" stroke="#d94e1e" stroke-width="1"></circle>
          </svg>
        </div>
        <div class="chart-labels" *ngIf="chartData.length > 0">
          <span>{{ chartData[0].month }} Start</span>
          <span>{{ chartData[3].month }} Current</span>
        </div>
      </div>
    </aside>

    <!-- MAIN TIMELINE -->
    <section class="logs-timeline-section">
      <div class="logs-header">
        <div>
          <h1 class="logs-title">
            Field Logs<br/>
            <span class="transparent-stroke">Archive DB</span>
          </h1>
        </div>
        <div class="logs-stats">
          <div class="logs-total-badge">
            TOTAL_ENTRIES: 42
          </div>
          <p class="logs-meta">
            Last Decryption: 2024.11.08<br/>
            Status: <span class="logs-status-online">ONLINE</span>
          </p>
        </div>
      </div>

      <div class="timeline-container">
        <div class="logs-timeline-line"></div>

        <!-- LOADING SKELETON -->
        <div *ngIf="isLoading" style="opacity: 0.7;">
          <div *ngFor="let i of [1,2,3]" class="timeline-item group timeline-item-even">
            <div class="timeline-date-wrapper">
              <div class="timeline-date-box tag-item-rotate-neg" style="background-color: #e5e7eb; width: 60px; height: 60px;"></div>
            </div>
            
            <div class="timeline-point">
              <div class="timeline-point-inner" style="background-color: #d1d5db;"></div>
            </div>
            
            <div class="timeline-content-wrapper">
              <div class="timeline-content-box" style="transform: rotate(1deg);">
                <div class="timeline-content-inner" style="background-color: #f3f4f6; animation: pulse 2s infinite;">
                  <div style="height: 12px; background-color: #d1d5db; margin-bottom: 24px; width: 40%;"></div>
                  <div style="height: 24px; background-color: #d1d5db; margin-bottom: 16px; width: 80%;"></div>
                  <div style="height: 12px; background-color: #e5e7eb; margin-bottom: 8px; width: 100%;"></div>
                  <div style="height: 12px; background-color: #e5e7eb; margin-bottom: 24px; width: 60%;"></div>
                  <div style="height: 20px; background-color: #d1d5db; width: 100px;"></div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <ng-container *ngIf="!isLoading">
          <div *ngFor="let log of logs; let i = index" 
               class="timeline-item group" 
               [ngClass]="i % 2 === 0 ? 'timeline-item-even' : 'timeline-item-odd'" 
               [routerLink]="['/logs', log.slug]">
             
          <div class="timeline-date-wrapper">
            <div class="timeline-date-box" [ngClass]="i % 2 === 0 ? 'tag-item-rotate-neg' : 'tag-item-rotate-pos'">
              <span class="timeline-date-day">{{ log.createdAt | date:'dd' }}</span>
              <span class="timeline-date-month" [style.color]="i % 2 === 0 ? 'var(--accent-orange)' : 'var(--primary)'">{{ log.createdAt | date:'MMM.yyyy' }}</span>
            </div>
          </div>
          
          <div class="timeline-point">
            <div class="timeline-point-inner" [style.background-color]="i % 2 === 0 ? 'var(--accent-orange)' : 'var(--primary)'"></div>
          </div>
          
          <div class="timeline-content-wrapper">
            <div class="timeline-content-box" [ngStyle]="{'transform': i % 2 === 0 ? 'rotate(1deg)' : 'rotate(-1deg)'}">
              <div class="timeline-content-inner">
                
                <ng-container *ngIf="i % 2 === 0; else alternativeTape">
                  <div class="tape-strip-long" style="top: -15px; right: -40px; transform: rotate(35deg);"></div>
                </ng-container>
                <ng-template #alternativeTape>
                  <div class="tape-strip" style="bottom: -10px; left: 10px; transform: rotate(-5deg); top: auto;"></div>
                </ng-template>

                <div class="timeline-meta-row">
                  <span class="timeline-log-id">LOG_{{ log.id.slice(0, 5) | uppercase }}</span>
                  <div style="display: flex; gap: 0.5rem;">
                    <span class="timeline-status" [ngClass]="i % 2 === 0 ? 'timeline-status-deployed' : 'timeline-status-analyzed'">
                      {{ i % 2 === 0 ? 'DEPLOYED' : 'ANALYZED' }}
                    </span>
                  </div>
                </div>
                
                <h2 class="timeline-log-title" [ngStyle]="{'color': ''}" style="transition: color 0.3s;"
                    [style.color]="'var(--charcoal)'">
                  {{ log.title }}
                </h2>
                
                <p class="timeline-log-preview">
                  {{ log.blocks.length > 0 ? log.blocks[0].content : 'No content' }}
                </p>
                
                <div class="timeline-footer">
                  <div class="timeline-tags">
                    <span *ngFor="let tag of log.tags" class="timeline-tag">#{{ tag }}</span>
                  </div>
                  <button class="btn-decrypt">
                    Decrypt_Full_Log &gt;
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
        
          <div *ngIf="logs.length === 0" class="empty-logs">
             <span class="empty-logs-text">No logs available. Create one in the admin panel.</span>
          </div>
        </ng-container>
      </div>
    </section>
  </div>
</main>
