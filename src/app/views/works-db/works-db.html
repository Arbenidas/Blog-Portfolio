<main class="works-main" id="works">
  <div class="coffee-stain" style="top: 8rem; right: 5rem; opacity: 0.4;"></div>
  <div class="coffee-stain" style="bottom: 5rem; left: 2.5rem; opacity: 0.6; transform: scale(0.75) rotate(45deg);"></div>

  <div class="works-header">
    <div class="works-header-line"></div>
    <div>
      <div class="works-title-container">
        <span class="material-symbols-outlined works-title-icon">folder_managed</span>
        <h1 class="works-title">Works<br/>Database</h1>
      </div>
      <p class="works-subtitle">
        // ACCESSING ARCHIVED PROJECT FILES...<br/>
        // DISPLAYING RELEVANT CASE STUDIES AND EXPERIMENTS.
      </p>
    </div>
    <div class="works-status-container">
      <div class="works-status-box">
        <div class="works-status-inner">
          <span class="works-status-dot"></span>
          <span class="works-status-text">SYSTEM STATUS: ONLINE</span>
        </div>
      </div>
      <div class="works-meta">
        LAST UPDATE: 2024.11.08<br/>
        FILES LOADED: 12/12
      </div>
    </div>
  </div>

  <div class="works-content-grid">
    <!-- LEFT SIDEBAR FILTER -->
    <aside class="works-sidebar">
      <div class="search-box">
        <label class="search-label">&gt; Search_Query_Input</label>
        <div class="search-input-wrapper">
          <input class="search-input" placeholder="Start typing..." type="text" [(ngModel)]="searchQuery" (ngModelChange)="applyFilters()"/>
          <span class="search-cursor" *ngIf="!searchQuery">_</span>
        </div>
      </div>

      <div class="filter-box">
        <div class="filter-box-label">Filter_Protocols</div>
        <div class="filter-list">
          <div class="filter-item">
            <span class="filter-item-name">Frontend_Dev</span>
            <label style="display:flex; cursor:pointer;">
              <input class="switch-toggle" type="checkbox" [(ngModel)]="filters.frontend" (ngModelChange)="applyFilters()"/>
            </label>
          </div>
          <div class="filter-item">
            <span class="filter-item-name">Backend_Sys</span>
            <label style="display:flex; cursor:pointer;">
              <input class="switch-toggle" type="checkbox" [(ngModel)]="filters.backend" (ngModelChange)="applyFilters()"/>
            </label>
          </div>
          <div class="filter-item">
            <span class="filter-item-name">UI_Design</span>
            <label style="display:flex; cursor:pointer;">
              <input class="switch-toggle" type="checkbox" [(ngModel)]="filters.design" (ngModelChange)="applyFilters()"/>
            </label>
          </div>
          <div class="filter-item">
            <span class="filter-item-name">Exp_Research</span>
            <label style="display:flex; cursor:pointer;">
              <input class="switch-toggle" type="checkbox" [(ngModel)]="filters.research" (ngModelChange)="applyFilters()"/>
            </label>
          </div>
          <div class="filter-divider"></div>
          <div class="filter-note">
            // ADJUST TOGGLES TO REFINE<br/>DATA VISUALIZATION
          </div>
        </div>
        <!-- Decorative corner screws -->
        <div class="screw" style="top:0.5rem; right:0.5rem;"><div class="screw-line"></div></div>
        <div class="screw" style="bottom:0.5rem; left:0.5rem;"><div class="screw-line"></div></div>
        <div class="screw" style="bottom:0.5rem; right:0.5rem;"><div class="screw-line"></div></div>
        <div class="screw" style="top:0.5rem; left:0.5rem;"><div class="screw-line"></div></div>
      </div>

      <div class="tech-stack-box">
        <h3 class="tech-stack-title">TECH_STACK_DENSITY</h3>
        <div class="tech-tags">
          <span *ngFor="let tech of techStackDensity" class="tech-tag">{{ tech.name }} ({{ tech.count | number:'2.0' }})</span>
        </div>
      </div>
    </aside>

    <!-- RIGHT GRID RESULTS -->
    <section class="works-list-container">

      <!-- LOADING STATE -->
      <div *ngIf="isLoading" class="works-list-grid" style="opacity: 0.7;">
        <div *ngFor="let i of [1,2,3,4,5,6]" class="work-card skeleton-card">
          <div class="work-card-inner" style="background-color: #f3f4f6; animation: pulse 2s infinite;">
            <div class="work-image-container" style="background-color: #e5e7eb; border-bottom: 2px solid var(--charcoal);"></div>
            <div style="height: 24px; background-color: #d1d5db; margin-bottom: 8px; width: 80%;"></div>
            <div style="height: 12px; background-color: #e5e7eb; margin-bottom: 16px; width: 100%;"></div>
            <div style="height: 12px; background-color: #e5e7eb; margin-bottom: 16px; width: 60%;"></div>
          </div>
        </div>
      </div>

      <div *ngIf="!isLoading" class="works-list-grid">
        <!-- DYNAMIC ITEMS -->
        <div *ngFor="let work of filteredWorks; let i = index" class="work-card fade-in-card" [style.animation-delay]="(i * 0.1) + 's'">
          <div class="work-ref-tab">
            <span class="work-ref-text">REF: {{ work.id.slice(0, 5) | uppercase }}</span>
          </div>
          <div class="work-card-inner">
            <div class="work-image-container">
              <img *ngIf="work.coverPhoto" [src]="work.coverPhoto" class="work-image-img" alt="Cover" />
              <div class="halftone-dots" style="position:absolute; inset:0; pointer-events:none; opacity:0.4;"></div>
              <div class="tape-strip-sm work-version-tape shadow-sketch" style="display:flex; align-items:center; justify-content:center;">
                <p class="work-version-text">v1.0</p>
              </div>
            </div>
            <h3 class="work-title" [routerLink]="['/works', work.slug]">
              {{ work.title }}
            </h3>
            <p class="work-preview">
              {{ work.blocks.length > 0 ? work.blocks[0].content : 'No content' | slice:0:60 }}...
            </p>
            <div class="work-footer">
              <div class="work-tags">
                <span *ngFor="let tag of work.tags" class="work-tag">{{ tag }}</span>
              </div>
              <button [routerLink]="['/works', work.slug]" class="btn-inspect group/btn">
                Inspect File <span class="material-symbols-outlined btn-inspect-icon">arrow_forward</span>
              </button>
            </div>
          </div>
        </div>
        
        <div *ngIf="filteredWorks.length === 0" class="empty-state">
           <span class="empty-state-text">No works match your search criteria.</span>
        </div>
      </div>

      <div class="load-more-container">
        <button class="btn-load-more">
          <span class="btn-loader"></span>
          <p class="btn-load-more-text">Load_More_Archives</p>
        </button>
      </div>
    </section>
  </div>
</main>
